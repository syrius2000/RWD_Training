% -*- coding:utf-8 -*-
\documentclass[uplatex,dvipdfmx,9pt,a4paper]{beamer}
% \documentclass[dvipdfmx, aspectratio=169]{beamer}

% --- 基本パッケージ ---
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{newtxtext,newtxmath}
\usepackage{amsmath,amscd,amsxtra,bm}
\usepackage{mathtools}
\mathtoolsset{showonlyrefs=true}
\usepackage[uplatex]{otf}
\usepackage{here}
\usepackage{booktabs}
% フォントの警告を抑制するために追加
\DeclareFontShape{JY2}{hmc}{b}{n}{<->ssub*hmc/bx/n}{}

% --- Beamer関連パッケージ ---
\usepackage{bxdpx-beamer}
\usepackage{pxjahyper} % しおりの文字化け対策 (hyperrefの後に読み込む)
\usepackage{xpatch}

% --- デザインテーマ ---
\usetheme{Madrid}
\usecolortheme{seahorse}
\usefonttheme{professionalfonts}
\usefonttheme[onlymath]{serif}

% --- Beamerテンプレート設定 ---
\setbeamertemplate{bibliography item}[number]
\setbeamertemplate{enumerate items}[default]
\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{footline}[frame number]

\AtBeginSection[]{
    \begin{frame}
        \frametitle{CURRENT section}
        \tableofcontents[currentsection]
    \end{frame}
}

% --- フォント設定 ---
\DeclareSymbolFont{operators}{OT1}{\sfdefault}{m}{n}
\SetSymbolFont{operators}{bold}{OT1}{\sfdefault}{b}{n}
\usefonttheme{structurebold}
\setbeamerfont{alerted text}{series=\bfseries}
\setbeamerfont{section in toc}{series=\mdseries}
\setbeamerfont{frametitle}{size=\Large}
\setbeamerfont{title}{size=\LARGE}
\setbeamerfont{date}{size=\small}
\setbeamerfont{bibliography item}{size=\footnotesize}
\setbeamerfont{bibliography entry author}{size=\footnotesize}
\setbeamerfont{bibliography entry title}{size=\footnotesize}
\setbeamerfont{bibliography entry location}{size=\footnotesize}
\setbeamerfont{bibliography entry note}{size=\footnotesize}

% --- tcolorbox (会話風ボックス) の設定 ---
\usepackage{tcolorbox}
\tcbuselibrary{skins, breakable}

% 会話ボックスの共通スタイル
\tcbset{
  chatstyle/.style={
    boxrule=0.5pt,
    arc=4mm,
    fonttitle=\bfseries,
    fontupper=\small, % ボックス内のフォントサイズをsmallに
    breakable,
  }
}

% 質問者（You）側の会話ボックス
\newtcolorbox{mychat}{
  chatstyle,
  colback=blue!5!white,
  colframe=blue!75!black,
  title={You},
}

% AI（Gemini）側の会話ボックス
\newtcolorbox{aichat}{
  chatstyle,
  colback=green!5!white,
  colframe=green!65!black,
  title={Gemini},
}

% --- ドキュメント開始 ---
\begin{document}

\begin{frame}[fragile]{AIとの会話サンプル}

  % --- 質問者の発言 ---
  \begin{mychat}
    利用DBとしてMySQL8.0を用いる。
    あるテーブルのあるカラムに対し、次の文字列を含むとき"1"、含まないとき"0"を出力するCASE文を作りたい。

    対象の文字列は以下の通り（先頭が一致すれば良い）：
    \begin{itemize}
        \item C00-C26, C30-C34, C37-C41
        \item C43-C58, C60-C85, C88, C90-C96
        \item D03, D46, Z85
    \end{itemize}
    特に、C00-C26の範囲は、`C00\%`, `C01\%`, ..., `C26\%` のように判定してほしい。
  \end{mychat}

  % --- AIの回答 ---
  \begin{aichat}
    \scriptsize
    \begin{verbatim}
SELECT
    your_column,
    CASE
        WHEN your_column REGEXP '^ (C(0[0-9]|1[0-9]|2[0-6]|3[0-4]|3[7-9]|4[0-1]|4[3-9]|5[0-8]|6[0-9]|7[0-9]|8[0-5]|88|9[0-6])|D(03|46)|Z85)'
        THEN 1
        ELSE 0
    END AS result_flag
FROM
    your_table;
    \end{verbatim}
  \small
  \end{aichat}

\end{frame}

\end{document}